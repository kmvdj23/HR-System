{% extends 'layouts/dashboard.html' %}

{% block page_content %}

    <!-- Page Heading -->
    <h1 class="h3 mb-2 text-gray-800">Dashboard</h1>

    <!-- Content Row -->
    <div class="row">

        <!-- Active Users -->
        <div class="col-xl-4 col-lg-4">
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Active Users</h6>
                </div>
                <div class="card-body">
                    {% for account in accounts %}
                        <div class="row mb-4">
                            <div class="col-xl-12 col-lg-12">
                                <div class="row">
                                    <div class="col-lg-3">
                                        <img class="img-profile rounded-circle sm-icon"
                                        src="../{{ account.profile_pic }}">
                                    </div>
                                    <div class="col-lg-9">
                                        <div style="display: flex; flex-direction: column;">
                                            {{ account.first_name }} {{ account.last_name }}
                                            <small>Last logged in: <time class="from-now"
                                            data-datetime="{{ account.last_sign_in_date }}">{{ account.last_sign_in_date }}</time></small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <!-- Types of Users -->
        <div class="col-xl-8 col-lg-8">
            <!-- Users Card Example -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Types of Users</h6>
                </div>
                <div class="card-body">
                    <h4 class="small font-weight-bold">IT <span class="float-right">{{ stats.user_types.get_it_percentage() + '%' }}</span></h4>
                    <div class="progress mb-4">
                        <div class="progress-bar bg-success" role="progressbar" style="width: {{ stats.user_types.get_it_percentage()  + '%' }}" aria-valuenow="{{ stats.user_types.get_it_percentage() }}" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <h4 class="small font-weight-bold">HR Admin <span class="float-right">{{ stats.user_types.get_admin_percentage() + '%' }}</span></h4>
                    <div class="progress mb-4">
                        <div class="progress-bar bg-info" role="progressbar" style="width: {{ stats.user_types.get_admin_percentage() + '%' }}" aria-valuenow="{{ stats.user_types.get_admin_percentage() }}" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <h4 class="small font-weight-bold">HR <span class="float-right">{{ stats.user_types.get_hr_percentage() + '%' }}</span></h4>
                    <div class="progress mb-4">
                        <div class="progress-bar" role="progressbar" style="width: {{ stats.user_types.get_hr_percentage() + '%'}}" aria-valuenow="{{ stats.user_types.get_hr_percentage() }}" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <!-- End of Content Row -->

{% endblock %}

{% block scripts %}
    <script type="text/javascript">
        $(document).ready(function() {
            // Date Formatting with momentjs
            $('.from-now').each(function(i, e) {
                ( function updateTime() {
                    var time = moment($(e).data('datetime'));
                    $(e).text(time.fromNow());
                    $(e).attr('title', time.format('MMMM Do YYYY, h:mm:ss a Z'));
                    setTimeout(updateTime, 1000);
                })();
            });
        });
    </script>
{% endblock %}
